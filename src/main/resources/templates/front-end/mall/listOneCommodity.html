<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="zh-Hant">

<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet"
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
<title th:text="${commodity.commodityName}">商品</title>
<style>
body {
	font-family: Arial, sans-serif;
	margin: 0;
	padding: 0;
	background-color: #f5f5f5;
}

.container {
	max-width: 1200px;
	margin: 0 auto;
	padding: 20px;
	display: flex;
	gap: 40px;
}

.product-image {
	flex: 1;
	text-align: center;
}

.product-image img {
	max-width: 100%;
	height: auto;
}

.product-details {
	flex: 1;
}

.product-title {
	font-size: 24px;
	color: #333;
	margin-bottom: 10px;
}

.product-subtitle {
	font-size: 18px;
	color: #666;
	margin-bottom: 20px;
}

.product-info {
	margin-bottom: 20px;
}

.product-description h3 {
	margin-bottom: 20px;
	color: #333;
}

.product-info p {
	margin: 5px 0;
	color: #666;
}

.price {
	font-size: 24px;
	color: #e74c3c;
	margin-bottom: 20px;
}

.quantity {
	display: flex;
	align-items: center;
	margin-bottom: 20px;
}

.quantity input {
	width: 50px;
	text-align: center;
	margin: 0 10px;
}

.add-to-cart {
	background-color: #3498db;
	color: white;
	border: none;
	padding: 10px 20px;
	font-size: 16px;
	cursor: pointer;
}

.product-description {
	/* margin-top: 40px; */
	text-align: center;
	/*max-width: 800px;*/
	/* 或者您認為合適的寬度 */
	margin: 40px auto 0;
	padding: 20px;
	padding-right: 300px;
	padding-left: 300px;
	background-color: #d9d9d9;
	border-radius: 8px;
	box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
}

.button-group {
	display: flex;
	gap: 10px;
}

.btn {
	text-decoration: none;
	color: inherit;
	padding: 10px 20px;
	border: none;
	cursor: pointer;
	font-size: 16px;
}

.add-to-cart, .buy-now {
	flex: 1;
	background-color: #2ecc71;
	color: white;
	border: none;
	padding: 10px 20px;
	font-size: 16px;
	cursor: pointer;
	display: flex;
	align-items: center;
	justify-content: center;
}

.add-to-cart {
	background-color: #e74c3c;
}

.add-to-cart i {
	margin-right: 5px;
}

/* 加入購物車 */
.modal {
	display: none;
	position: fixed;
	z-index: 1000;
	left: 0;
	top: 0;
	width: 100%;
	height: 100%;
	background-color: rgba(0, 0, 0, 0.4);
}

.modal-content {
	background-color: #fefefe;
	margin: 15% auto;
	padding: 20px;
	border: 1px solid #888;
	width: 300px;
	text-align: center;
	border-radius: 5px;
}

.close {
	color: #aaa;
	float: right;
	font-size: 28px;
	font-weight: bold;
	cursor: pointer;
}

.close:hover, .close:focus {
	color: #000;
	text-decoration: none;
	cursor: pointer;
}
</style>
</style>
</head>

<body>
	<div id="header"></div>


	<div id="cartModal" class="modal">
		<div class="modal-content">
			<span class="close">&times;</span>
			<p>商品已成功加入購物車！</p>
		</div>
	</div>


	<div class="container">
		<div class="product-image">

			<img th:if="${not #lists.isEmpty(commodity.commodityPictures)}"
				th:src="@{/commodity/CommodityDBGifReader(commodityPictureID=${commodity.commodityPictures[0].commodityPictureID})}"
				th:alt="${commodity.commodityName}">
			<div th:if="${#lists.isEmpty(commodity.commodityPictures)}"
				class="placeholder-image">無圖片</div>
		</div>




		<div class="product-details">





			<h1 class="product-title"
				th:text="${commodity.getActivity().getActivityName()}">活動名稱</h1>
			<h2 class="product-subtitle" th:text="${commodity.commodityName}">商品名稱</h2>
			<div class="product-info">
				<p th:text="'商品編號：' + ${commodity.commodityID}">商品編號</p>
				<p
					th:text="'上架日期：' + ${#dates.format(commodity.commodityPostTime, 'yyyy.MM.dd')}">上架日期</p>
			</div>
			<div class="price" th:text="'$' + ${commodity.commodityPrice}">價格</div>
			<div class="quantity">
				<button onclick="decreaseQuantity()">-</button>
				<input type="number" id="quantity" value="1" min="1">
				<button onclick="increaseQuantity()">+</button>
			</div>



			<!-- <div class="button-group">
        <a href="checkout.html">
          <button class="buy-now">直接購買</button>
        </a>
        <button class="add-to-cart"><i class="fas fa-shopping-cart"></i> 加入購物車</button>
      </div> -->


	

			<div class="button-group">
				<button class="buy-now" onclick="proceedToCheckout()">前往結帳</button>
				<button class="add-to-cart"
					th:attr="data-commodity-id=${commodity.commodityID}">
					<i class="fas fa-shopping-cart"></i> 加入購物車
				</button>
			</div>




		</div>
	</div>




	<div class="container">
		<div class="product-description">
			<h3>商品介紹</h3>
			<p th:text="${commodity.commodityContent}">商品介紹內容</p>
		</div>
	</div>



	<div id="footer"></div>





	<script>
    // 獲取模態框元素
    var modal = document.getElementById("cartModal");

    // 獲取所有"加入購物車"按鈕
    var btns = document.getElementsByClassName("add-to-cart");

    // 獲取 <span> 元素，用於關閉模態框
    var span = document.getElementsByClassName("close")[0];

    // 為每個"加入購物車"按鈕添加點擊事件
    Array.from(btns).forEach(function (btn) {
      btn.onclick = function (event) {
        event.preventDefault(); // 阻止默認行為（如果按鈕在 <a> 標籤內）
        modal.style.display = "block";
      }
    });

    // 當用戶點擊 <span> (x)，關閉模態框
    span.onclick = function () {
      modal.style.display = "none";
    }

    // 當用戶點擊模態框外的任何地方，關閉它
    window.onclick = function (event) {
      if (event.target == modal) {
        modal.style.display = "none";
      }
    }
  </script>

	<script>
    function decreaseQuantity() {
      var quantity = document.getElementById('quantity');
      if (quantity.value > 1) {
        quantity.value = parseInt(quantity.value) - 1;
      }
    }

    function increaseQuantity() {
      var quantity = document.getElementById('quantity');
      quantity.value = parseInt(quantity.value) + 1;
    }

    function proceedToCheckout() {
      // 跳轉到結帳頁面
      // alert('前往結帳頁面');
      // window.location.href = '/templates/front-end/mall/mall-checkout.html';
      window.location.href = 'mall-cart.html';


    }
  </script>

	<script th:inline="javascript">
    // 保留原有的 JavaScript 代碼
    
    // 更新加入購物車按鈕的點擊事件
    document.querySelector('.add-to-cart').addEventListener('click', function() {
      const commodityId = this.getAttribute('data-commodity-id');
      // 這裡添加將商品添加到購物車的 Ajax 請求
      // ...

      // 顯示模態框
      document.getElementById('cartModal').style.display = 'block';
    });

    function proceedToCheckout() {
      const commodityId = /*[[${commodity.commodityID}]]*/ '';
      window.location.href = '/mall/checkout?commodityID=' + commodityId;
    }
  </script>



	<script th:inline="javascript">
    document.addEventListener('DOMContentLoaded', function() {
        // 初始化所有的 tooltips
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // 動態載入 header
        if (!document.getElementById('header').innerHTML.trim()) {
            fetch('/header')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('header').innerHTML = data;
                })
                .catch(error => {
                    console.error('Error loading header:', error);
                    document.getElementById('header').innerHTML = '<p>Error loading header</p>';
                });
        }

        // 動態載入 footer
        if (!document.getElementById('footer').innerHTML.trim()) {
            fetch('/footer')
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(data => {
                    document.getElementById('footer').innerHTML = data;
                })
                .catch(error => {
                    console.error('Error loading footer:', error);
                    document.getElementById('footer').innerHTML = '<p>Error loading footer</p>';
                });
        }

    });
</script>
	<script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>
	<script src="script.js"></script>
</body>

</html>